{"ast":null,"code":"import { makeStyles, Box, Container, Typography } from '@material-ui/core';\nimport { SpeedDial, SpeedDialAction } from '@material-ui/lab';\nimport React__default, { useState, createElement } from 'react';\nimport AccountBalanceWalletIcon from '@material-ui/icons/AccountBalanceWallet';\nimport WalletConnectProvider from '@walletconnect/web3-provider';\nimport 'web3';\nimport Web3Modal from 'web3modal';\n\nfunction DragMove(props) {\n  const {\n    onPointerDown,\n    onPointerUp,\n    onPointerMove,\n    onDragMove,\n    children,\n    style,\n    className\n  } = props;\n  const [isDragging, setIsDragging] = useState(false);\n\n  const handlePointerDown = e => {\n    setIsDragging(true);\n    onPointerDown(e);\n  };\n\n  const handlePointerUp = e => {\n    setIsDragging(false);\n    onPointerUp(e);\n  };\n\n  const handlePointerMove = e => {\n    if (isDragging) onDragMove(e);\n    onPointerMove(e);\n  };\n\n  return React__default.createElement(\"div\", {\n    onPointerDown: handlePointerDown,\n    onPointerUp: handlePointerUp,\n    onPointerMove: handlePointerMove,\n    style: style,\n    className: className\n  }, children);\n}\n\nDragMove.defaultProps = {\n  onPointerDown: () => {},\n  onPointerUp: () => {},\n  onPointerMove: () => {}\n};\nconst providerNetwork = `http://localhost:8545`;\nconst useStyles = makeStyles({\n  root: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    minWidth: '100vw',\n    minHeight: '100vh',\n    background: 'rgba(50,0,0,0.25)',\n    pointerEvents: 'none'\n  },\n  speedDial: {\n    position: 'fixed',\n    bottom: 20,\n    right: 20,\n    zIndex: 1000000000\n  },\n  byoaButton: {}\n});\nconst providerOptions = {\n  walletconnect: {\n    display: {\n      name: \"Mobile\"\n    },\n    package: WalletConnectProvider,\n    options: {\n      infuraId: \"6430aa46e9354b91bea44e464af71f7a\"\n    }\n  }\n};\nconst web3Modal = new Web3Modal({\n  network: providerNetwork,\n  cacheProvider: true,\n  disableInjectedProvider: false,\n  providerOptions\n});\n\nconst ByoaSDK = props => {\n  const classes = useStyles();\n  const [translateDial, setTranslateDial] = useState({\n    x: 0,\n    y: 0\n  });\n  const [dialDirection, setDialDirection] = useState(\"up\");\n  const [openDial, setOpenDial] = useState(false);\n  const [provider, setProvider] = useState(null);\n  const [web3, setWeb3] = useState(null);\n  const [accountAddress, setAccountAddress] = useState(null);\n  const [installedApps, setInstalledApps] = useState([]);\n  return createElement(Box, {\n    className: classes.root\n  }, createElement(Container, {\n    className: classes.speedDial\n  }, createElement(DragMove, {\n    onDragMove: e => {\n      setTranslateDial({\n        x: translateDial.x + e.movementX,\n        y: translateDial.y + e.movementY\n      });\n\n      if (e.clientY < 200) {\n        if (dialDirection !== \"down\") setDialDirection(\"down\");\n      }\n\n      if (e.clientY > 200) {\n        if (dialDirection !== \"up\") setDialDirection(\"up\");\n      }\n    }\n  }, createElement(SpeedDial, {\n    style: {\n      transform: `translateX(${translateDial.x}px) translateY(${translateDial.y}px)`\n    },\n    ariaLabel: \"BYOA Speed Dial\",\n    hidden: false,\n    icon: createElement(Typography, {\n      className: classes.byoaButton\n    }, \"RUN\"),\n    open: openDial,\n    onOpen: () => {\n      setOpenDial(true);\n    },\n    onClose: () => {\n      setOpenDial(false);\n    },\n    onClick: () => {},\n    direction: dialDirection\n  }, createElement(SpeedDialAction, {\n    key: 'sda-connect-wallet',\n    icon: createElement(AccountBalanceWalletIcon, null),\n    tooltipTitle: 'Connect Wallet',\n    onClick: () => {\n      setOpenDial(false);\n    }\n  })))));\n};\n\nexport { ByoaSDK };","map":{"version":3,"sources":["../src/components/DragMove.tsx","../src/index.tsx"],"names":["DragMove","props","className","useState","handlePointerDown","e","setIsDragging","onPointerDown","handlePointerUp","onPointerUp","handlePointerMove","onDragMove","onPointerMove","style","providerNetwork","useStyles","makeStyles","root","position","top","left","minWidth","minHeight","background","pointerEvents","speedDial","bottom","right","zIndex","byoaButton","providerOptions","walletconnect","display","name","package","options","infuraId","web3Modal","network","cacheProvider","disableInjectedProvider","ByoaSDK","classes","x","y","React","setTranslateDial","translateDial","movementY","dialDirection","setDialDirection","transform","ariaLabel","hidden","icon","open","openDial","onOpen","setOpenDial","onClose","onClick","direction","key","tooltipTitle"],"mappings":";;;;;;;;SAGwBA,Q,CAASC,K,EAAAA;AAC/B,QAAM;AAAA,IAAA,aAAA;AAAA,IAAA,WAAA;AAAA,IAAA,aAAA;AAAA,IAAA,UAAA;AAAA,IAAA,QAAA;AAAA,IAAA,KAAA;AAOJC,IAAAA;AAPI,MAAN,KAAA;AAUA,QAAM,CAAA,UAAA,EAAA,aAAA,IAA8BC,QAAQ,CAA5C,KAA4C,CAA5C;;AAGA,QAAMC,iBAAiB,GAAIC,CAAD,IAAA;AACxBC,IAAAA,aAAa,CAAbA,IAAa,CAAbA;AAEAC,IAAAA,aAAa,CAAbA,CAAa,CAAbA;AAHF,GAAA;;AAOA,QAAMC,eAAe,GAAIH,CAAD,IAAA;AACtBC,IAAAA,aAAa,CAAbA,KAAa,CAAbA;AAEAG,IAAAA,WAAW,CAAXA,CAAW,CAAXA;AAHF,GAAA;;AAOA,QAAMC,iBAAiB,GAAIL,CAAD,IAAA;AACxB,QAAA,UAAA,EAAgBM,UAAU,CAAVA,CAAU,CAAVA;AAEhBC,IAAAA,aAAa,CAAbA,CAAa,CAAbA;AAHF,GAAA;;AAMA,SACE,cAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AACEL,IAAAA,aAAa,EAAEH,iBADjB;AAEEK,IAAAA,WAAW,EAAED,eAFf;AAGEI,IAAAA,aAAa,EAAEF,iBAHjB;AAIEG,IAAAA,KAAK,EAAEA,KAJT;AAKEX,IAAAA,SAAS,EAAEA;AALb,GAAA,EADF,QACE,CADF;AAWD;;AAEDF,QAAQ,CAARA,YAAAA,GAAwB;AACtBO,EAAAA,aAAa,EAAE,MAAA,CADO,CAAA;AAEtBE,EAAAA,WAAW,EAAE,MAAA,CAFS,CAAA;AAGtBG,EAAAA,aAAa,EAAE,MAAA,CAAA;AAHO,CAAxBZ;AClCA,MAAMc,eAAe,GAArB,uBAAA;AAEA,MAAMC,SAAS,GAAGC,UAAU,CAAC;AAC3BC,EAAAA,IAAI,EAAE;AACJC,IAAAA,QAAQ,EADJ,OAAA;AAEJC,IAAAA,GAAG,EAFC,CAAA;AAGJC,IAAAA,IAAI,EAHA,CAAA;AAIJC,IAAAA,QAAQ,EAJJ,OAAA;AAKJC,IAAAA,SAAS,EALL,OAAA;AAMJC,IAAAA,UAAU,EANN,mBAAA;AAOJC,IAAAA,aAAa,EAAE;AAPX,GADqB;AAU3BC,EAAAA,SAAS,EAAE;AACTP,IAAAA,QAAQ,EADC,OAAA;AAETQ,IAAAA,MAAM,EAFG,EAAA;AAGTC,IAAAA,KAAK,EAHI,EAAA;AAITC,IAAAA,MAAM,EAAE;AAJC,GAVgB;AAgB3BC,EAAAA,UAAU,EAAE;AAhBe,CAAD,CAA5B;AAqBA,MAAMC,eAAe,GAAG;AACtBC,EAAAA,aAAa,EAAE;AACbC,IAAAA,OAAO,EAAE;AACPC,MAAAA,IAAI,EAAE;AADC,KADI;AAIbC,IAAAA,OAAO,EAJM,qBAAA;AAKbC,IAAAA,OAAO,EAAE;AACPC,MAAAA,QAAQ,EAAE;AADH;AALI;AADO,CAAxB;AAYA,MAAMC,SAAS,GAAG,IAAA,SAAA,CAAc;AAC9BC,EAAAA,OAAO,EADuB,eAAA;AAE9BC,EAAAA,aAAa,EAFiB,IAAA;AAG9BC,EAAAA,uBAAuB,EAHO,KAAA;AAI9BV,EAAAA;AAJ8B,CAAd,CAAlB;;AAQA,MAAaW,OAAO,GAAIxC,KAAD,IAAA;AACrB,QAAMyC,OAAO,GAAG3B,SAAhB,EAAA;AACA,QAAM,CAAA,aAAA,EAAA,gBAAA,IAAoC,QAAA,CAAe;AACvD4B,IAAAA,CAAC,EADsD,CAAA;AAEvDC,IAAAA,CAAC,EAAE;AAFoD,GAAf,CAA1C;AAIA,QAAM,CAAA,aAAA,EAAA,gBAAA,IAAoCC,QAAAA,CAA1C,IAA0CA,CAA1C;AACA,QAAM,CAAA,QAAA,EAAA,WAAA,IAA0BA,QAAAA,CAAhC,KAAgCA,CAAhC;AACA,QAAM,CAAA,QAAA,EAAA,WAAA,IAA0BA,QAAAA,CAAhC,IAAgCA,CAAhC;AACA,QAAM,CAAA,IAAA,EAAA,OAAA,IAAkBA,QAAAA,CAAxB,IAAwBA,CAAxB;AACA,QAAM,CAAA,cAAA,EAAA,iBAAA,IAAsCA,QAAAA,CAA5C,IAA4CA,CAA5C;AAGA,QAAM,CAAA,aAAA,EAAA,gBAAA,IAAoCA,QAAAA,CAA1C,EAA0CA,CAA1C;AAqFA,SACE,aAAA,CAAA,GAAA,EAAA;AAAK3C,IAAAA,SAAS,EAAEwC,OAAO,CAACzB;AAAxB,GAAA,EACE,aAAA,CAAA,SAAA,EAAA;AAAWf,IAAAA,SAAS,EAAEwC,OAAO,CAACjB;AAA9B,GAAA,EACE,aAAA,CAAA,QAAA,EAAA;AAAUd,IAAAA,UAAU,EAAGN,CAAD,IAAA;AACpByC,MAAAA,gBAAgB,CAAC;AACfH,QAAAA,CAAC,EAAEI,aAAa,CAAbA,CAAAA,GAAkB1C,CAAC,CADP,SAAA;AAEfuC,QAAAA,CAAC,EAAEG,aAAa,CAAbA,CAAAA,GAAkB1C,CAAC,CAAC2C;AAFR,OAAD,CAAhBF;;AAIA,UAAIzC,CAAC,CAADA,OAAAA,GAAJ,GAAA,EAAqB;AACnB,YAAI4C,aAAa,KAAjB,MAAA,EAA8BC,gBAAgB,CAAhBA,MAAgB,CAAhBA;AAC/B;;AACD,UAAI7C,CAAC,CAADA,OAAAA,GAAJ,GAAA,EAAqB;AACnB,YAAI4C,aAAa,KAAjB,IAAA,EAA4BC,gBAAgB,CAAhBA,IAAgB,CAAhBA;AAC7B;AACF;AAXD,GAAA,EAYE,aAAA,CAAA,SAAA,EAAA;AACErC,IAAAA,KAAK,EAAE;AACLsC,MAAAA,SAAS,EAAA,cAAgBJ,aAAa,CAACJ,CAAAA,kBAAmBI,aAAa,CAACH,CAAAA;AADnE,KADT;AAIEQ,IAAAA,SAAS,EAAC,iBAJZ;AAKEC,IAAAA,MAAM,EAAE,KALV;AAMEC,IAAAA,IAAI,EAAE,aAAA,CAAA,UAAA,EAAA;AAAYpD,MAAAA,SAAS,EAAEwC,OAAO,CAACb;AAA/B,KAAA,EAAA,KAAA,CANR;AAOE0B,IAAAA,IAAI,EAAEC,QAPR;AAQEC,IAAAA,MAAM,EAAE,MAAA;AACNC,MAAAA,WAAW,CAAXA,IAAW,CAAXA;AACD,KAVH;AAWEC,IAAAA,OAAO,EAAE,MAAA;AACPD,MAAAA,WAAW,CAAXA,KAAW,CAAXA;AACD,KAbH;AAcEE,IAAAA,OAAO,EAAE,MAAA,CAAA,CAdX;AAiBEC,IAAAA,SAAS,EAAEZ;AAjBb,GAAA,EAmBE,aAAA,CAAA,eAAA,EAAA;AACEa,IAAAA,GAAG,EAAE,oBADP;AAEER,IAAAA,IAAI,EAAET,aAAAA,CAAAA,wBAAAA,EAAAA,IAAAA,CAFR;AAGEkB,IAAAA,YAAY,EAAE,gBAHhB;AAIEH,IAAAA,OAAO,EAAE,MAAA;AACPF,MAAAA,WAAW,CAAXA,KAAW,CAAXA;AACD;AANH,GAAA,CAnBF,CAZF,CADF,CADF,CADF;AAlGK,CAAP","sourcesContent":["import React, { useState } from \"react\";\n\n// @ts-expect-error\nexport default function DragMove(props) {\n  const {\n    onPointerDown,\n    onPointerUp,\n    onPointerMove,\n    onDragMove,\n    children,\n    style,\n    className\n  } = props;\n\n  const [isDragging, setIsDragging] = useState(false);\n\n  // @ts-expect-error\n  const handlePointerDown = (e) => {\n    setIsDragging(true);\n\n    onPointerDown(e);\n  };\n\n  // @ts-expect-error\n  const handlePointerUp = (e) => {\n    setIsDragging(false);\n\n    onPointerUp(e);\n  };\n\n  // @ts-expect-error\n  const handlePointerMove = (e) => {\n    if (isDragging) onDragMove(e);\n\n    onPointerMove(e);\n  };\n\n  return (\n    <div\n      onPointerDown={handlePointerDown}\n      onPointerUp={handlePointerUp}\n      onPointerMove={handlePointerMove}\n      style={style}\n      className={className}\n    >\n      {children}\n    </div>\n  );\n}\n\nDragMove.defaultProps = {\n  onPointerDown: () => {},\n  onPointerUp: () => {},\n  onPointerMove: () => {}\n};\n","import { Box, Container, makeStyles, Typography } from '@material-ui/core';\nimport { SpeedDial, SpeedDialAction } from '@material-ui/lab';\nimport * as React from 'react';\nimport DragMove from './components/DragMove';\nimport AccountBalanceWalletIcon from '@material-ui/icons/AccountBalanceWallet';\nimport WalletConnectProvider from '@walletconnect/web3-provider';\nimport Web3 from 'web3';\nimport Web3Modal from \"web3modal\";\nimport { InstalledApp } from './types/installedApp';\nimport abi from './utils/abi/Byoa.json';\n\ninterface Props {\n  \n}\n\nconst byoaContractAddress = `0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512`;\nconst providerNetwork = `http://localhost:8545`;\n\nconst useStyles = makeStyles({\n  root: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    minWidth: '100vw',\n    minHeight: '100vh',\n    background: 'rgba(50,0,0,0.25)',\n    pointerEvents: 'none'\n  },\n  speedDial: {\n    position: 'fixed',\n    bottom: 20,\n    right: 20,\n    zIndex: 1000000000\n  },\n  byoaButton: {\n\n  }\n});\n\nconst providerOptions = {  \n  walletconnect: {\n    display: {\n      name: \"Mobile\"\n    },\n    package: WalletConnectProvider,\n    options: {\n      infuraId: \"6430aa46e9354b91bea44e464af71f7a\" // required\n    }\n  }\n};\n\nconst web3Modal = new Web3Modal({\n  network: providerNetwork, // optional\n  cacheProvider: true, // optional\n  disableInjectedProvider: false,\n  providerOptions // required\n});\n\n// @ts-expect-error\nexport const ByoaSDK = (props : Props) => {\n  const classes = useStyles();\n  const [translateDial, setTranslateDial] = React.useState({\n    x: 0,\n    y: 0\n  });\n  const [dialDirection, setDialDirection] = React.useState<\"left\" | \"right\" | \"up\" | \"down\" | undefined>(\"up\");\n  const [openDial, setOpenDial] = React.useState(false);\n  const [provider, setProvider] = React.useState<any>(null);\n  const [web3, setWeb3] = React.useState<any>(null);\n  const [accountAddress, setAccountAddress] = React.useState<String | null>(null);\n\n  // @ts-expect-error\n  const [installedApps, setInstalledApps] = React.useState<InstalledApp[]>([]);\n\n\n  // @ts-expect-error\n  const connectWallet = async () => {\n    try {\n      let p = provider;\n      if (p === null) {\n        p = await web3Modal.connect();\n        if(p === null) {\n          throw new Error('Unable to connect provider to modal');\n        }\n        p.on('accountsChanged', (e : any) => {\n            console.log(e);\n          disconnectWallet();\n        });\n            p.on(\"chainChanged\", (chainId: number) => {\n                console.log(\"chain \" + chainId);\n            });\n        setProvider(p);\n      }\n\n      let w3 = web3;\n      if (w3 === null) {\n        w3 = new Web3(p);\n        if (w3 === null) {\n          throw new Error('Unable to connect web3');\n        }\n        setWeb3(w3);\n      }\n\n      const accounts = await p.request({method: 'eth_accounts'});\n      if (accounts.length > 0) {\n        setAccountAddress(accounts[0]);\n        setTimeout( async () => {\n            refreshMyApps(accounts[0]);\n        }, 2000);\n      }\n    } catch (error) {\n      console.log(error);\n      alert('Unable to connect wallet. Please try again.');\n    }\n  };\n\n  \n\n  const disconnectWallet = async () => {\n    await web3Modal.clearCachedProvider();\n    setProvider(null);\n    setAccountAddress(null);\n  };\n\n  const refreshMyApps = async (addressHelper : String | undefined | null) => {\n    let w3 = new Web3(providerNetwork);\n    try {\n        // @ts-expect-error\n        let contract = new w3.eth.Contract(abi.abi, byoaContractAddress);\n      \n        let myTokenIds = await contract.methods.walletOfOwner(accountAddress ? accountAddress : addressHelper).call();\n        console.log(myTokenIds);\n\n        let appLUT : any = {};\n        \n\n        let allInstalls : InstalledApp[] = [];\n        for (var i = 0; i < myTokenIds.length; i ++) {\n            let tid = parseInt(myTokenIds[i]);\n            let appIdForToken = await contract.methods.getAppIdByTokenId(tid).call();\n\n            let ia : InstalledApp = {\n                id: tid,\n                tokenURI: \"\",\n                app: appLUT[appIdForToken]\n            }\n\n            allInstalls.push(ia);\n        }\n        console.log(allInstalls)\n        setInstalledApps(allInstalls);\n      \n    } catch( error ) {\n      console.log(`Error fetching apps: ${error}`) ;\n    }\n  };\n  \n  return (\n    <Box className={classes.root}>\n      <Container className={classes.speedDial}>\n        <DragMove onDragMove={(e : any) => {\n          setTranslateDial({\n            x: translateDial.x + e.movementX,\n            y: translateDial.y + e.movementY\n          });\n          if (e.clientY < 200) {\n            if (dialDirection !== \"down\") setDialDirection(\"down\");\n          }\n          if (e.clientY > 200) {\n            if (dialDirection !== \"up\") setDialDirection(\"up\");\n          }\n        }}>\n          <SpeedDial\n            style={{\n              transform: `translateX(${translateDial.x}px) translateY(${translateDial.y}px)`\n            }}\n            ariaLabel=\"BYOA Speed Dial\"\n            hidden={false}\n            icon={<Typography className={classes.byoaButton}>RUN</Typography>}\n            open={openDial}\n            onOpen={() => {\n              setOpenDial(true);\n            }}\n            onClose={() => {\n              setOpenDial(false);\n            }}\n            onClick={() => {\n              \n            }}\n            direction={dialDirection}\n          >\n            <SpeedDialAction\n              key={'sda-connect-wallet'}\n              icon={<AccountBalanceWalletIcon />}\n              tooltipTitle={'Connect Wallet'}\n              onClick={() => {\n                setOpenDial(false);\n              }}\n            />\n\n          </SpeedDial>\n        </DragMove>\n          \n      </Container>\n    </Box>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}