{"code":"import { Box, Container, makeStyles, Typography } from '@material-ui/core';\r\nimport { SpeedDial, SpeedDialAction } from '@material-ui/lab';\r\nimport * as React from 'react';\r\nimport DragMove from './components/DragMove';\r\nimport AccountBalanceWalletIcon from '@material-ui/icons/AccountBalanceWallet';\r\nimport WalletConnectProvider from '@walletconnect/web3-provider';\r\nimport Web3 from 'web3';\r\nimport Web3Modal from \"web3modal\";\r\nvar byoaAbi = require('./utils/abi/Byoa.json');\r\nconst byoaContractAddress = `0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512`;\r\nconst providerNetwork = `http://localhost:8545`;\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        minWidth: '100vw',\r\n        minHeight: '100vh',\r\n        background: 'rgba(50,0,0,0.25)',\r\n        pointerEvents: 'none'\r\n    },\r\n    speedDial: {\r\n        position: 'fixed',\r\n        bottom: 20,\r\n        right: 20,\r\n        zIndex: 1000000000\r\n    },\r\n    byoaButton: {}\r\n});\r\nconst providerOptions = {\r\n    walletconnect: {\r\n        display: {\r\n            name: \"Mobile\"\r\n        },\r\n        package: WalletConnectProvider,\r\n        options: {\r\n            infuraId: \"6430aa46e9354b91bea44e464af71f7a\" // required\r\n        }\r\n    }\r\n};\r\nconst web3Modal = new Web3Modal({\r\n    network: providerNetwork,\r\n    cacheProvider: true,\r\n    disableInjectedProvider: false,\r\n    providerOptions // required\r\n});\r\n// @ts-expect-error\r\nexport const ByoaSDK = (props) => {\r\n    const classes = useStyles();\r\n    const [translateDial, setTranslateDial] = React.useState({\r\n        x: 0,\r\n        y: 0\r\n    });\r\n    const [dialDirection, setDialDirection] = React.useState(\"up\");\r\n    const [openDial, setOpenDial] = React.useState(false);\r\n    const [provider, setProvider] = React.useState(null);\r\n    const [web3, setWeb3] = React.useState(null);\r\n    const [accountAddress, setAccountAddress] = React.useState(null);\r\n    // @ts-expect-error\r\n    const [installedApps, setInstalledApps] = React.useState([]);\r\n    // @ts-expect-error\r\n    const connectWallet = async () => {\r\n        try {\r\n            let p = provider;\r\n            if (p === null) {\r\n                p = await web3Modal.connect();\r\n                if (p === null) {\r\n                    throw new Error('Unable to connect provider to modal');\r\n                }\r\n                p.on('accountsChanged', (e) => {\r\n                    console.log(e);\r\n                    disconnectWallet();\r\n                });\r\n                p.on(\"chainChanged\", (chainId) => {\r\n                    console.log(\"chain \" + chainId);\r\n                });\r\n                setProvider(p);\r\n            }\r\n            let w3 = web3;\r\n            if (w3 === null) {\r\n                w3 = new Web3(p);\r\n                if (w3 === null) {\r\n                    throw new Error('Unable to connect web3');\r\n                }\r\n                setWeb3(w3);\r\n            }\r\n            const accounts = await p.request({ method: 'eth_accounts' });\r\n            if (accounts.length > 0) {\r\n                setAccountAddress(accounts[0]);\r\n                setTimeout(async () => {\r\n                    refreshMyApps(accounts[0]);\r\n                }, 2000);\r\n            }\r\n        }\r\n        catch (error) {\r\n            console.log(error);\r\n            alert('Unable to connect wallet. Please try again.');\r\n        }\r\n    };\r\n    const disconnectWallet = async () => {\r\n        await web3Modal.clearCachedProvider();\r\n        setProvider(null);\r\n        setAccountAddress(null);\r\n    };\r\n    const refreshMyApps = async (addressHelper) => {\r\n        let w3 = new Web3(providerNetwork);\r\n        try {\r\n            let contract = new w3.eth.Contract(byoaAbi['abi'], byoaContractAddress);\r\n            let myTokenIds = await contract.methods.walletOfOwner(accountAddress ? accountAddress : addressHelper).call();\r\n            console.log(myTokenIds);\r\n            let appLUT = {};\r\n            let allInstalls = [];\r\n            for (var i = 0; i < myTokenIds.length; i++) {\r\n                let tid = parseInt(myTokenIds[i]);\r\n                let appIdForToken = await contract.methods.getAppIdByTokenId(tid).call();\r\n                let ia = {\r\n                    id: tid,\r\n                    tokenURI: \"\",\r\n                    app: appLUT[appIdForToken]\r\n                };\r\n                allInstalls.push(ia);\r\n            }\r\n            console.log(allInstalls);\r\n            setInstalledApps(allInstalls);\r\n        }\r\n        catch (error) {\r\n            console.log(`Error fetching apps: ${error}`);\r\n        }\r\n    };\r\n    return (React.createElement(Box, { className: classes.root },\r\n        React.createElement(Container, { className: classes.speedDial },\r\n            React.createElement(DragMove, { onDragMove: (e) => {\r\n                    setTranslateDial({\r\n                        x: translateDial.x + e.movementX,\r\n                        y: translateDial.y + e.movementY\r\n                    });\r\n                    if (e.clientY < 200) {\r\n                        if (dialDirection !== \"down\")\r\n                            setDialDirection(\"down\");\r\n                    }\r\n                    if (e.clientY > 200) {\r\n                        if (dialDirection !== \"up\")\r\n                            setDialDirection(\"up\");\r\n                    }\r\n                } },\r\n                React.createElement(SpeedDial, { style: {\r\n                        transform: `translateX(${translateDial.x}px) translateY(${translateDial.y}px)`\r\n                    }, ariaLabel: \"BYOA Speed Dial\", hidden: false, icon: React.createElement(Typography, { className: classes.byoaButton }, \"RUN\"), open: openDial, onOpen: () => {\r\n                        setOpenDial(true);\r\n                    }, onClose: () => {\r\n                        setOpenDial(false);\r\n                    }, onClick: () => {\r\n                    }, direction: dialDirection },\r\n                    React.createElement(SpeedDialAction, { key: 'sda-connect-wallet', icon: React.createElement(AccountBalanceWalletIcon, null), tooltipTitle: 'Connect Wallet', onClick: () => {\r\n                            setOpenDial(false);\r\n                        } }))))));\r\n};\r\n//# sourceMappingURL=index.js.map","references":["/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/node_modules/@material-ui/core/index.d.ts","/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/node_modules/@material-ui/lab/index.d.ts","/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/node_modules/@types/react/index.d.ts","/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/src/components/DragMove.tsx","/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/node_modules/@material-ui/icons/AccountBalanceWallet.d.ts","/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/node_modules/@walletconnect/web3-provider/dist/cjs/index.d.ts","/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/node_modules/web3/types/index.d.ts","/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/node_modules/web3modal/dist/index.d.ts","/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/src/types/installedApp.ts"],"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/index.tsx\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/pagreczner/src/mallows/react-libraries/byoa-sdk/index.d.ts","writeByteOrderMark":false,"text":"interface Props {\r\n}\r\nexport declare const ByoaSDK: (props: Props) => JSX.Element;\r\nexport {};\r\n"}}
